{% load staticfiles %}

<!DOCTYPE html>

<html lang="en-us">
  <head>
    <title>LeagueHQ | {{ leagueName }}</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    <link rel="icon" type="image/png" href="{% static 'img/favicon.png' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- custom scrollbar CSS -->
    <link rel="stylesheet" href="http://malihu.github.io/custom-scrollbar/jquery.mCustomScrollbar.min.css">
    <!-- jQuery lib -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- custom scrollbar plugin script -->
    <script src="http://malihu.github.io/custom-scrollbar/jquery.mCustomScrollbar.concat.min.js"></script>
    <!-- custom charts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>

    <script>
        function myFunction(x) {
            x.classList.toggle("change");
        }
    </script>
  </head>

  <body>
    <!--Preloader-->


    <!--Navigation-->
    <nav class="navbar navbar-expand-lg navbar-dark menu">
      <div class="container justify-content-right"
            <a class="navbar-brand" href="#"><img src="{% static 'img/lhq.svg' %}" width="200" height="37"></a>
        <div class="menubox align-middle" onclick="myFunction(this)">
            <div class="bar1"></div>
            <div class="bar2"></div>
            <div class="bar3"></div>
        </div>
      </div>
    </nav>

    <!--Content-->
    <div class="container">
      <div class="row row-eq-height top-buffer">
        <div class="col">
            <div class="leaguename">
                <h1>{{ leagueName }}</h1>
                <h6>League Id: {{ leagueId }}  |  Since {{ firstSeason }}</h6>
            </div>
            <div class="panel centered board">
                <h3>Trash Talk</h3>
                <p>Dont' hold anything back. Demolish your opponents, anonymously or not.</p>
                <form>
                    <div>
                        <div class="form-group">
                          <input
                            type="text"
                            placeholder="Anonymous">
                          <textarea
                            placeholder="Message"
                            required="required"
                            rows="3">
                          </textarea>
                          <button type="submit">post</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <div class="col">
            <div class="panel-white centered half">
                <h3>Humiliation</h3>
                <br>
                <img src="{{ lower.logo }}" width="75px">
                <br>
                <h5>{{ lower.name }}</h5>
                <p>Scored {{ lowest }} points on Week {{ lower.week }}</p>
            </div>
            <div class="panel-transparent board-highlight half align-middle">
                <h4>Heaven Cheesehead com um excelente record, como de costume. Hora de perder nos playoffs. #NoRings</h4>
                <br>
                <h6>Anonymous</h6>
            </div>
        </div>
        <div class="col">
            <div class="panel centered">
                <div class="row standingsTitle">
                  <h3>Overall Standings</h3>
                </div>
                <div class="standingsTable">
                  <div class="row tableRowTop justify-content-between align-items-center">
                    <div class="pos"><p>Pos.</p></div>
                    <div class="lwl"><p>Logo</p></div>
                    <div class="team justify-content-start"><p>Team</p></div>
                    <div class="lwl"><p>W</p></div>
                    <div class="lwl"><p>L</p></div>
                  </div>
                  {% for s in standings %}
                  <div class="row tableRow justify-content-between align-items-center">
                    <div class="pos"><p>{{ s.standing }}</p></div>
                    <div class="lwl"><img src="{{ s.logo }}" height="35px"></div>
                    <div class="team justify-content-start"><p class="teamName">{{ s.name }}</p></div>
                    <div class="lwl"><p>{{ s.wins }}</p></div>
                    <div class="lwl"><p>{{ s.losses }}</p></div>
                  </div>
                    {% if forloop.counter < standings|length %}
                      <div class="row dividerline">
                      </div>
                    {% endif %}
                  {% endfor %}
                </div>
            </div>
        </div>
      </div>
      <div class="row row-eq-height top-buffer">
        <div class="col">
          <div class="panel centered">
              <h3>Regular Season Scores</h3>
              <canvas id="line-chart" width="800" height="250"></canvas>
          </div>
        </div>
      </div>
      <div class="row top-buffer">
        <div class="col">
          <div id="panelwin" class="centered">
              <h3>Lord of the Rings</h3>
              <br>
              {% for winner in winners %}
              <img src="{{ winner.logo }}" width="75px">
              <br>
              <h5>{{ winner.name }}</h5>
              <br>
              <div class="row dividerline"></div>
              <br>
              {% endfor %}
              <p><span class="count">{{ maxrings }}</span><br>championships</p>
          </div>
          <div id="twitter-widget-holder" class="top-buffer">
              <a class="twitter-timeline" href="https://twitter.com/pedroperone/lists/fantasy-football?ref_src=twsrc%5Etfw" data-width="300" data-heigth="600" data-chrome="noheader" data-tweet-limit="5"></a>
              <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
          </div>
        </div>
        <div class="col">
          <div class="panel-brown centered">
              <h3>You Suck</h3>
              <br>
              {% for loser in losers %}
              <img src="{{ loser.logo }}" width="75px">
              <br>
              <h5>{{ loser.name }}</h5>
              <br>
              <div class="row dividerline"></div>
              <br>
              {% endfor %}
              <p><span class="count">{{ minrings }}</span><br>championships</p>
          </div>
        </div>
        <div class="col">
            <div id="messageboard" class="panel-transparent centered">
                <h3> Trash Talk </h3>
            </div>
        </div>
        </div>
      </div>
    </div>

    <footer class="foot">
        <div class="container">
            <p>LeagueHQ. 2018 All rights reserved.</p>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

    <script>
        teamScores = [];
        counter = 0;

        for(let w = 1; w <= 12; w++) {
            var url = new URL('https://games.espn.com/ffl/api/v2/scoreboard')
            var params = {leagueId:1002885, seasonId:2018, matchupPeriodId:w}
            url.search = new URLSearchParams(params)
            fetch(url)
            .then(response => response.json())
            .then(data => {
                var scores = data;
                for (let m = 0; m < 4; m++) {
                    for (let t = 0; t < 2; t++) {
                        var ts = {};
                        var week = w;
                        ts['teamAbbrev'] = scores['scoreboard']['matchups'][m]['teams'][t]['team']['teamAbbrev'];
                        ts['week'] = w;
                        ts['scores'] = scores['scoreboard']['matchups'][m]['teams'][t]['score'];
                        teamScores.push(ts);
                    }
                }
            })
        }

        setTimeout(function afterEightSeconds() {
            sortedTS = teamScores.sort(function(obj1, obj2) {
                return obj1.week - obj2.week;
            });
        }, 8000)

        new Chart(document.getElementById("line-chart"), {
            type: 'line',
                data: {
                labels: [1,2,3,4,5,6,7,8,9,10,11,12],
                datasets: [
                  {
                    data: teamScores[0].scores,
                    label: teamScores[0].teamAbbrev,
                    borderColor: "#34D0E5",
                    fill: false
                  }, {
                    data: [182,150,111,102,135,109,147,102,100,167,150,111],
                    label: "HCH",
                    borderColor: "#CEC38C",
                    fill: false
                  }, {
                    data: [168,170,178,190,203,276,108,47,75,234,170,178],
                    label: "Bags",
                    borderColor: "#DDAB82",
                    fill: false
                  }, {
                    data: [40,120,110,116,124,138,74,167,108,84,124,138],
                    label: "JLLE",
                    borderColor: "#C9FF8C",
                    fill: false
                  }, {
                    data: [86,53,72,92,97,126,82,172,132,133,126,82],
                    label: "OCV",
                    borderColor: "#ACA9D3",
                    fill: false
                }, {
                  data: [168,170,178,190,103,176,108,147,175,134,170,178],
                  label: "MATT",
                  borderColor: "#C9C9C9",
                  fill: false
                }, {
                  data: [40,20,10,16,24,38,74,167,138,184,170,178],
                  label: "Val",
                  borderColor: "#FFF47C",
                  fill: false
                }, {
                  data: [86,88,92,82,87,126,82,172,112,133,92,82],
                  label: "ING",
                  borderColor: "#DDA1BC",
                  fill: false
                }
                ]
                },
                options: {
                title: {
                  display: false,
                  text: 'Season Scores'
                }
            }
        });
    </script>
  </body>
</html>
